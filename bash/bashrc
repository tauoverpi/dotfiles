# Bash initialization for interactive non-login shells and
# for remote shells (info "(bash) Bash Startup Files").

# Export 'SHELL' to child processes.  Programs such as 'screen'
# honor it and otherwise use /bin/sh.
export SHELL

if [[ $- != *i* ]]
then
    # We are being invoked from a non-interactive shell.  If this
    # is an SSH session (as in "ssh host command"), source
    # /etc/profile so we get PATH and other essential variables.
    [[ -n "$SSH_CLIENT" ]] && source /etc/profile

    # Don't do anything else.
    return
fi

# Source the system-wide file.
eval $(thefuck --alias)
source /etc/bashrc

# Adjust the prompt depending on whether we're in 'guix environment'.
if [ -n "$GUIX_ENVIRONMENT" ]
then
    PS1='\u@\h \w [env] λ '
else
    PS1='\u@\h \w λ '
fi
alias ls='ls -p -F --color=none'
alias ll='ls -l'
alias grep='grep --color=none'

# still need to rewrite this...
export MPD_HOST=127.0.0.1
# export GUIX_PACKAGE_PATH=$HOME/projects/packages
export IDRIS_CC=gcc
export EDITOR=nvim
export PATH=$HOME/.local/bin:$PATH

alias reconfigure='sudo -E guix system reconfigure $HOME/projects/sr.ht/dotfiles/guix/config.scm'

toWav ()
{
	sox -r 8000 -e unsigned -b 8 -c 1 $1 $2
}

share ()
{
	uri=$(curl -F"file=@$1" https://0x0.st)
	echo $uri | xclip -sel clip
	echo $uri
}

shareclip() {
	xclip -sel clip -o > /tmp/shareclip
	share /tmp/shareclip
}

shorten ()
{
	uri=$(curl -F"shorten=$1" https://0x0.st)
	echo $uri | xclip -sel clip
	echo $uri
}

url()
{
	uri=$(curl -F"url=$1" https://0x0.st)
	echo $uri | xclip -sel clip
	echo $uri
}

ytdl ()
{
	youtube-dl -io '%(title)s.%(ext)s' \
		--external-downloader=aria2c \
		--geo-bypass \
		$@
}

wcap ()
{
	target="/tmp/tmp.png"
	[ -z $1 ] || target=$1
	scrot -s $target
	share $target
}

scap ()
{
	target="/tmp/tmp.png"
	[ -z $1 ] || target=$1
	scrot $target
	share $target
}

search ()
{
	links "https://searx.me/?preferences=eJx1VUuP1DAM_jX0Ug3iceDUAwIhkJAWMQvXyE08rWkalzid2fLrcWb7WnY4TEdN7O_hxG5EGX0Sw8EEvJgEdfUJvGDhmExEYX_GWImlQzvWL9Ol8BCaERqsMBx-HAvPFnx-KRwJ1B6dGfzYUJDqJ_UHTx2allOHk7x48-FuwJBRldJ4Ct3KW0e-CMbMn-O-hBMFSmjERvZ-yXxvLYqYj3dfFOQSNaCgXrWYIfLDNAuHMbHlfvCYsCoETigI0bbVqyK12GPFYiEWGJ6qPaI_GeXl2EMiDlnGfQTbqaof378qYc9aCl39fH__7bgI0PfjFT47sZCw4TgZQY82bSXBoBwoVUe2A3VgTuQxM5wiYil8SheIWDqKmpYBDCXdPTMkY4QtgS97dAS6SAGMOZNDzgARnaPnQWOQwYO0CpQLlCMb5sZjqctTCcOwE_FxdFpc02DACLnYjpo6bfsNNWoDJO1jFmI9vasRF5nclhMmgB35anwVvpfTj0LWmOufbllrD-l8w-TG3iB2iXqUuVKPdAvArH_NB9sIj_8j5zPhXtnrh51wQXQD6h1YwXv-peR7MQv8msR6WSMOvKvxhvPM1ZqG2gS5hhvyCSLzWuMW6gj5MZvO147OWJLcUrPorSnVo17jNGdN0GbMHUnUTiSwz-7KDSXbAqap56BN_CQscTdxYmm5g7BpeDye1fkpQg-e6oizpn7qtb3iVKYIQby2kbtlaSlmTgWNzhHy1L1Tq_nXcPno5uZZPr2ly9s_4le583VazPwTtp3wnwD9XotcSMTqYNtrsBBiKSmONo0xy9PZisHiFSGfqGWHZX7MtdmhbNCv375997C_0JQ81EtGgpiGPBf3hXFN6fA6VvN022-tzXl1uE7GZWhNEBw-3C7yfvX3BcLWpEWPqWVXfbs73hfzYNQ-q5bt6xQ-SJr06-G5oez4_BfilHiF&q=$(echo $@ | sed 's/ /%20/g')"
}
alias s=search

build ()
{
	ssh builder /home/nyberg/.config/guix/current/bin/guix archive --export $@ | guix archive --import
}

b4 ()
{
	echo -e "#include <stdio.h>\nint main(void) { for(int t = 0;; t++) { int x = $@; putchar(x); } return 0; }" > /tmp/bb.c
        gcc /tmp/bb.c -o /tmp/bb
        /tmp/bb | aplay -
}

undecorate()
{
	 xprop -f _MOTIF_WM_HINTS 32c -set _MOTIF_WM_HINTS "0x2, 0x0, 0x0, 0x0, 0x0"
}

machinecode()
{
	pushd /tmp
	while read l
	do
		echo -e "format ELF64 executable 3\n$l" > c4.asm
		fasm c4.asm
		echo
		hexdump -C -s 120 c4
		echo
		echo -n "> "
	done
	popd
}

spoiler()
{
	links http://1novels.com/243724-fifty-shades-freed.html
}
